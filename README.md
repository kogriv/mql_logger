# –ü—Ä–æ—Ñ–µ—Å—Å–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è MQL5

–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –¥–ª—è MetaTrader 5 —Å –º–æ–¥—É–ª—å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–æ–π, –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∞–º–∏ –∏ —Ä–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–º–∏ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏.

## üöÄ –í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–ú–æ–¥—É–ª—å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞** - –ª–µ–≥–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –Ω–æ–≤—ã—Ö –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤ –∏ —Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä–æ–≤
- **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏** - –∫–æ–Ω—Å–æ–ª—å, —Ñ–∞–π–ª—ã, –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö SQLite
- **–ì–∏–±–∫–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** - –ø—Ä–æ—Å—Ç–æ–µ –∏ –¥–µ—Ç–∞–ª—å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π
- **–ü—Ä–æ–¥–≤–∏–Ω—É—Ç–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è** - –ø–æ —É—Ä–æ–≤–Ω—é –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è –∏ —Ä–µ–≥—É–ª—è—Ä–Ω—ã–º –≤—ã—Ä–∞–∂–µ–Ω–∏—è–º
- **Thread-safety** - –∑–∞—â–∏—Ç–∞ –æ—Ç –∫–æ–Ω—Ñ–ª–∏–∫—Ç–æ–≤ –≤ –ø—Å–µ–≤–¥–æ-–º–Ω–æ–≥–æ–ø–æ—Ç–æ—á–Ω–æ–π —Å—Ä–µ–¥–µ MQL5
- **–§–∞–±—Ä–∏–∫–∞ –ª–æ–≥–≥–µ—Ä–æ–≤** - —Ü–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–æ–µ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
- **–£–¥–æ–±–Ω—ã–µ –º–∞–∫—Ä–æ—Å—ã** - –±—ã—Å—Ç—Ä–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —É–∫–∞–∑–∞–Ω–∏–µ–º –∏—Å—Ç–æ—á–Ω–∏–∫–∞

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
Logger.mqh                     // –ì–ª–∞–≤–Ω—ã–π —Ñ–∞–π–ª –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
‚îú‚îÄ‚îÄ Core/
‚îÇ   ‚îú‚îÄ‚îÄ LogRecord.mqh          // –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ª–æ–≥-–∑–∞–ø–∏—Å–∏ –∏ —É—Ä–æ–≤–Ω–∏
‚îÇ   ‚îú‚îÄ‚îÄ Interfaces.mqh         // –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ã —Å–∏—Å—Ç–µ–º—ã
‚îÇ   ‚îú‚îÄ‚îÄ Logger.mqh             // –û—Å–Ω–æ–≤–Ω–æ–π –∫–ª–∞—Å—Å –ª–æ–≥–≥–µ—Ä–∞
‚îÇ   ‚îî‚îÄ‚îÄ Macros.mqh            // –ú–∞–∫—Ä–æ—Å—ã –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
‚îú‚îÄ‚îÄ Handlers/
‚îÇ   ‚îú‚îÄ‚îÄ ConsoleHandler.mqh     // –í—ã–≤–æ–¥ –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª MetaTrader
‚îÇ   ‚îú‚îÄ‚îÄ FileHandler.mqh        // –ó–∞–ø–∏—Å—å –≤ —Ñ–∞–π–ª—ã
‚îÇ   ‚îî‚îÄ‚îÄ SqliteHandler.mqh      // –ó–∞–ø–∏—Å—å –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
‚îú‚îÄ‚îÄ Formatters/
‚îÇ   ‚îú‚îÄ‚îÄ SimpleFormatter.mqh    // –ü—Ä–æ—Å—Ç–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îÇ   ‚îî‚îÄ‚îÄ DetailedFormatter.mqh  // –î–µ—Ç–∞–ª—å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ
‚îú‚îÄ‚îÄ Filters/
‚îÇ   ‚îú‚îÄ‚îÄ LevelFilter.mqh        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —É—Ä–æ–≤–Ω—é
‚îÇ   ‚îî‚îÄ‚îÄ RegexFilter.mqh        // –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É
‚îî‚îÄ‚îÄ Factory/
    ‚îî‚îÄ‚îÄ LoggerFactory.mqh      // –§–∞–±—Ä–∏–∫–∞ –ª–æ–≥–≥–µ—Ä–æ–≤
```

## üéØ –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

```cpp
enum ENUM_LOG_LEVEL
{
   LOG_TRACE = 0,    // –î–µ—Ç–∞–ª—å–Ω–∞—è –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
   LOG_DEBUG = 1,    // –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è
   LOG_INFO = 2,     // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
   LOG_WARN = 3,     // –ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
   LOG_ERROR = 4,    // –û—à–∏–±–∫–∏
   LOG_FATAL = 5     // –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
}
```

## üõ† –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```cpp
#include "Logger.mqh"

void OnStart()
{
   // –ü–æ–ª—É—á–∏—Ç—å –ª–æ–≥–≥–µ—Ä –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
   ILogger* logger = GetLogger();
   
   // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö —É—Ä–æ–≤–Ω–µ–π
   logger.Info("–°–æ–≤–µ—Ç–Ω–∏–∫ –∑–∞–ø—É—â–µ–Ω");
   logger.Warn("–í–Ω–∏–º–∞–Ω–∏–µ: –Ω–∏–∑–∫–∏–π –±–∞–ª–∞–Ω—Å");
   logger.Error("–û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –ø–æ–∑–∏—Ü–∏–∏", GetLastError());
}
```

### 2. –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –º–∞–∫—Ä–æ—Å–æ–≤ (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

```cpp
#include "Logger.mqh"

void OnTick()
{
   LOG_TRACE("–ü–æ–ª—É—á–µ–Ω –Ω–æ–≤—ã–π —Ç–∏–∫");
   
   double price = SymbolInfoDouble(_Symbol, SYMBOL_BID);
   LOG_INFO("–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞: " + DoubleToString(price, _Digits));
   
   if(price < 1.0000)
   {
      LOG_WARN("–¶–µ–Ω–∞ –Ω–∏–∂–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–æ–≥–æ —É—Ä–æ–≤–Ω—è!");
   }
}

void OnTradeTransaction(const MqlTradeTransaction& trans,
                       const MqlTradeRequest& request,
                       const MqlTradeResult& result)
{
   if(result.retcode != TRADE_RETCODE_DONE)
   {
      LOG_ERROR("–û—à–∏–±–∫–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Ç–æ—Ä–≥–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏");
   }
   else
   {
      LOG_INFO("–¢–æ—Ä–≥–æ–≤–∞—è –æ–ø–µ—Ä–∞—Ü–∏—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ");
   }
}
```

## üìù –ü—Ä–∏–º–µ—Ä—ã –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

### 1. –õ–æ–≥–≥–µ—Ä —Ç–æ–ª—å–∫–æ –¥–ª—è –∫–æ–Ω—Å–æ–ª–∏

```cpp
void CreateConsoleLogger()
{
   // –°–æ–∑–¥–∞—Ç—å –ª–æ–≥–≥–µ—Ä –¥–ª—è –≤—ã–≤–æ–¥–∞ –≤ –∫–æ–Ω—Å–æ–ª—å
   ILogger* logger = CLoggerFactory::CreateConsoleLogger("console", LOG_DEBUG);
   
   logger.Info("–°–æ–æ–±—â–µ–Ω–∏–µ –≤ –∫–æ–Ω—Å–æ–ª—å");
   logger.Debug("–û—Ç–ª–∞–¥–æ—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ");
}
```

### 2. –õ–æ–≥–≥–µ—Ä –¥–ª—è –∑–∞–ø–∏—Å–∏ –≤ —Ñ–∞–π–ª

```cpp
void CreateFileLogger()
{
   // –°–æ–∑–¥–∞—Ç—å –ª–æ–≥–≥–µ—Ä –¥–ª—è –∑–∞–ø–∏—Å–∏ –≤ —Ñ–∞–π–ª
   ILogger* logger = CLoggerFactory::CreateFileLogger("trading", "trading.log", LOG_INFO);
   
   logger.Info("–ó–∞–ø–∏—Å—å –≤ —Ñ–∞–π–ª trading.log");
   logger.Warn("–ü—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª–µ");
   
   // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤ —Ñ–∞–π–ª
   logger.Flush();
}
```

### 3. –õ–æ–≥–≥–µ—Ä —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

```cpp
void CreateDatabaseLogger()
{
   // –°–æ–∑–¥–∞—Ç—å –ª–æ–≥–≥–µ—Ä –¥–ª—è –∑–∞–ø–∏—Å–∏ –≤ SQLite
   ILogger* logger = CLoggerFactory::CreateDatabaseLogger("db_logger", "logs.db", LOG_INFO);
   
   logger.Info("–ó–∞–ø–∏—Å—å –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö");
   logger.Error("–û—à–∏–±–∫–∞ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö", 123);
}
```

### 4. –ö–æ–º–ø–æ–∑–∏—Ç–Ω—ã–π –ª–æ–≥–≥–µ—Ä (–Ω–µ—Å–∫–æ–ª—å–∫–æ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–æ–≤)

```cpp
void CreateCompositeLogger()
{
   // –°–æ–∑–¥–∞—Ç—å –ª–æ–≥–≥–µ—Ä —Å –≤—ã–≤–æ–¥–æ–º –≤ –∫–æ–Ω—Å–æ–ª—å –∏ —Ñ–∞–π–ª
   ILogger* logger = CLoggerFactory::CreateCompositeLogger("multi", true, "app.log", "");
   
   logger.Info("–≠—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ—è–≤–∏—Ç—Å—è –∏ –≤ –∫–æ–Ω—Å–æ–ª–∏, –∏ –≤ —Ñ–∞–π–ª–µ");
}
```

## üé® –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### 1. –ü—Ä–æ—Å—Ç–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```cpp
void SetupSimpleFormatter()
{
   ILogger* logger = CLoggerFactory::CreateLogger("formatted");
   CConsoleHandler* handler = CLoggerFactory::CreateConsoleHandler();
   
   // –°–æ–∑–¥–∞—Ç—å –ø—Ä–æ—Å—Ç–æ–π —Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä
   CSimpleFormatter* formatter = CLoggerFactory::CreateSimpleFormatter(
      "%timestamp% [%level%] %message%"
   );
   
   handler.SetFormatter(formatter);
   logger.AddHandler(handler);
   
   logger.Info("–°–æ–æ–±—â–µ–Ω–∏–µ —Å –ø—Ä–æ—Å—Ç—ã–º —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º");
}
```

### 2. –î–µ—Ç–∞–ª—å–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```cpp
void SetupDetailedFormatter()
{
   ILogger* logger = CLoggerFactory::CreateLogger("detailed");
   CFileHandler* handler = CLoggerFactory::CreateFileHandler("detailed.log");
   
   // –°–æ–∑–¥–∞—Ç—å –¥–µ—Ç–∞–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä
   CDetailedFormatter* formatter = CLoggerFactory::CreateDetailedFormatter(
      "%timestamp% [%level%] %logger%: %message% %source_info% %error_info%",
      false  // –Ω–µ –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç
   );
   
   handler.SetFormatter(formatter);
   logger.AddHandler(handler);
   
   logger.Info("–î–µ—Ç–∞–ª—å–Ω–æ –æ—Ç—Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ");
}
```

### 3. –ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–æ–µ —Ñ–æ—Ä–º–∞—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

```cpp
void SetupMultilineFormatter()
{
   ILogger* logger = CLoggerFactory::CreateLogger("multiline");
   CConsoleHandler* handler = CLoggerFactory::CreateConsoleHandler();
   
   // –°–æ–∑–¥–∞—Ç—å –º–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç—Ç–µ—Ä
   CDetailedFormatter* formatter = CLoggerFactory::CreateDetailedFormatter("", true);
   
   handler.SetFormatter(formatter);
   logger.AddHandler(handler);
   
   logger.Error("–ú–Ω–æ–≥–æ—Å—Ç—Ä–æ—á–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ", 404);
}
```

## üîç –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è —Å–æ–æ–±—â–µ–Ω–∏–π

### 1. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —É—Ä–æ–≤–Ω—é

```cpp
void SetupLevelFilter()
{
   ILogger* logger = CLoggerFactory::CreateLogger("filtered");
   CConsoleHandler* handler = CLoggerFactory::CreateConsoleHandler();
   
   // –ü–æ–∫–∞–∑—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –∏ –æ—à–∏–±–∫–∏
   CLevelFilter* filter = CLoggerFactory::CreateLevelFilter(LOG_WARN);
   handler.SetFilter(filter);
   
   logger.AddHandler(handler);
   
   logger.Debug("–≠—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –ù–ï –ø–æ—è–≤–∏—Ç—Å—è");
   logger.Info("–≠—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –ù–ï –ø–æ—è–≤–∏—Ç—Å—è");
   logger.Warn("–≠—Ç–æ –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏–µ –ü–û–Ø–í–ò–¢–°–Ø");
   logger.Error("–≠—Ç–∞ –æ—à–∏–±–∫–∞ –ü–û–Ø–í–ò–¢–°–Ø");
}
```

### 2. –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É

```cpp
void SetupRegexFilter()
{
   ILogger* logger = CLoggerFactory::CreateLogger("regex_filtered");
   CFileHandler* handler = CLoggerFactory::CreateFileHandler("trades_only.log");
   
   // –ó–∞–ø–∏—Å—ã–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏—è –æ —Ç–æ—Ä–≥–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏—è—Ö
   CRegexFilter* filter = CLoggerFactory::CreateRegexFilter(false); // –±–µ–∑ —É—á–µ—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞
   filter.AddTradePatterns(); // –¥–æ–±–∞–≤–∏—Ç—å —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ —Ç–æ—Ä–≥–æ–≤—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã
   filter.AddIncludePattern("–æ—Ä–¥–µ—Ä");
   filter.AddIncludePattern("–ø–æ–∑–∏—Ü–∏—è");
   
   handler.SetFilter(filter);
   logger.AddHandler(handler);
   
   logger.Info("–û—Ç–∫—Ä—ã—Ç –æ—Ä–¥–µ—Ä BUY"); // –ó–∞–ø–∏—à–µ—Ç—Å—è
   logger.Info("–ó–∞–∫—Ä—ã—Ç–∞ –ø–æ–∑–∏—Ü–∏—è SELL"); // –ó–∞–ø–∏—à–µ—Ç—Å—è  
   logger.Info("–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è"); // –ù–ï –∑–∞–ø–∏—à–µ—Ç—Å—è
}
```

## üìä –ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∞–≤—Ç–æ-—Å–±—Ä–æ—Å–∞

```cpp
void SetupAutoFlush()
{
   ILogger* logger = CLoggerFactory::CreateLogger("auto_flush");
   
   // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–±—Ä–∞—Å—ã–≤–∞—Ç—å –±—É—Ñ–µ—Ä—ã –∫–∞–∂–¥—ã–µ 30 —Å–µ–∫—É–Ω–¥
   logger.SetAutoFlushInterval(30);
   
   CFileHandler* handler = CLoggerFactory::CreateFileHandler("auto_flush.log", true, false);
   logger.AddHandler(handler);
   
   logger.Info("–≠—Ç–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –±—É–¥–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ —á–µ—Ä–µ–∑ 30 —Å–µ–∫—É–Ω–¥");
}
```

### 2. –†–æ—Ç–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤ –ø–æ —Ä–∞–∑–º–µ—Ä—É

```cpp
void SetupFileRotation()
{
   ILogger* logger = CLoggerFactory::CreateLogger("rotating");
   CFileHandler* handler = CLoggerFactory::CreateFileHandler("rotating.log");
   
   // –†–æ—Ç–∏—Ä–æ–≤–∞—Ç—å —Ñ–∞–π–ª –ø—Ä–∏ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–∏ 1MB
   handler.SetMaxFileSize(1024 * 1024);
   
   logger.AddHandler(handler);
   
   for(int i = 0; i < 10000; i++)
   {
      logger.Info("–°–æ–æ–±—â–µ–Ω–∏–µ –Ω–æ–º–µ—Ä " + IntegerToString(i));
   }
}
```

### 3. –ü–∞–∫–µ—Ç–Ω–∞—è –∑–∞–ø–∏—Å—å –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö

```cpp
void SetupBatchDatabase()
{
   CSqliteHandler* handler = CLoggerFactory::CreateSqliteHandler("batch.db", "logs");
   
   // –ó–∞–ø–∏—Å—ã–≤–∞—Ç—å –≤ –±–∞–∑—É –ø–∞–∫–µ—Ç–∞–º–∏ –ø–æ 50 –∑–∞–ø–∏—Å–µ–π
   handler.SetBatchSize(50);
   handler.SetAutoCommit(false);
   
   ILogger* logger = CLoggerFactory::CreateLogger("batch");
   logger.AddHandler(handler);
   
   // –≠—Ç–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –±—É–¥—É—Ç –∑–∞–ø–∏—Å–∞–Ω—ã –æ–¥–Ω–∏–º –ø–∞–∫–µ—Ç–æ–º
   for(int i = 0; i < 100; i++)
   {
      logger.Info("–ü–∞–∫–µ—Ç–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ " + IntegerToString(i));
   }
   
   logger.Flush(); // –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ –∑–∞–ø–∏—Å–∞—Ç—å –æ—Å—Ç–∞–≤—à–∏–µ—Å—è
}
```

## üéØ –°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–µ –º–∞–∫—Ä–æ—Å—ã

### 1. –ú–∞–∫—Ä–æ—Å—ã –¥–ª—è —Ç–æ—Ä–≥–æ–≤—ã—Ö –æ–ø–µ—Ä–∞—Ü–∏–π

```cpp
void TradeExample()
{
   string symbol = "EURUSD";
   double volume = 0.1;
   double price = 1.1234;
   double profit = 15.50;
   
   // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç–∏—è —Å–¥–µ–ª–∫–∏
   LOG_TRADE_OPEN(symbol, ORDER_TYPE_BUY, volume, price);
   
   // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–∫—Ä—ã—Ç–∏—è —Å–¥–µ–ª–∫–∏
   LOG_TRADE_CLOSE(symbol, volume, price, profit);
}
```

### 2. –ú–∞–∫—Ä–æ—Å—ã –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏

```cpp
void PerformanceExample()
{
   // –ò–∑–º–µ—Ä–∏—Ç—å –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –±–ª–æ–∫–∞ –∫–æ–¥–∞
   LOG_EXECUTION_TIME("–†–∞—Å—á–µ—Ç –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä–æ–≤", {
      // –ó–¥–µ—Å—å –≤–∞—à –∫–æ–¥ –¥–ª—è –∏–∑–º–µ—Ä–µ–Ω–∏—è
      for(int i = 0; i < 1000; i++)
      {
         MathSin(i * 0.01);
      }
   });
}
```

### 3. –ú–∞–∫—Ä–æ—Å—ã –≤—Ö–æ–¥–∞/–≤—ã—Ö–æ–¥–∞ –∏–∑ —Ñ—É–Ω–∫—Ü–∏–π

```cpp
void ExampleFunction()
{
   LOG_FUNCTION_ENTRY(); // –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—Ö–æ–¥ –≤ —Ñ—É–Ω–∫—Ü–∏—é
   
   // –í–∞—à –∫–æ–¥ —Ñ—É–Ω–∫—Ü–∏–∏
   Sleep(100);
   
   LOG_FUNCTION_EXIT();  // –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å –≤—ã—Ö–æ–¥ –∏–∑ —Ñ—É–Ω–∫—Ü–∏–∏
}
```

### 4. –£—Å–ª–æ–≤–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

```cpp
void ConditionalLogging()
{
   double balance = AccountInfoDouble(ACCOUNT_BALANCE);
   
   // –õ–æ–≥–∏—Ä–æ–≤–∞—Ç—å —Ç–æ–ª—å–∫–æ –ø—Ä–∏ –Ω–∏–∑–∫–æ–º –±–∞–ª–∞–Ω—Å–µ
   LOG_IF(balance < 1000, LOG_WARN, "–ù–∏–∑–∫–∏–π –±–∞–ª–∞–Ω—Å: " + DoubleToString(balance, 2));
}
```

## üè≠ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ–∞–±—Ä–∏–∫–∏ –ª–æ–≥–≥–µ—Ä–æ–≤

### 1. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é

```cpp
void SetupDefaultConfig()
{
   SLoggerConfig config;
   config.level = LOG_DEBUG;
   config.console_output = true;
   config.file_output = true;
   config.log_file = "default.log";
   config.detailed_format = true;
   config.auto_flush = false;
   config.flush_interval = 60;
   
   CLoggerFactory::SetDefaultConfig(config);
   
   // –¢–µ–ø–µ—Ä—å –≤—Å–µ –Ω–æ–≤—ã–µ –ª–æ–≥–≥–µ—Ä—ã –±—É–¥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —ç—Ç—É –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—é
   ILogger* logger = GetLogger("test");
}
```

### 2. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—Å–µ–º–∏ –ª–æ–≥–≥–µ—Ä–∞–º–∏

```cpp
void ManageAllLoggers()
{
   // –°–±—Ä–æ—Å–∏—Ç—å –≤—Å–µ –±—É—Ñ–µ—Ä—ã –≤—Å–µ—Ö –ª–æ–≥–≥–µ—Ä–æ–≤
   FlushAllLoggers();
   
   // –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —É—Ä–æ–≤–µ–Ω—å –¥–ª—è –≤—Å–µ—Ö –ª–æ–≥–≥–µ—Ä–æ–≤
   CLoggerFactory::SetGlobalLevel(LOG_WARN);
   
   // –í–∫–ª—é—á–∏—Ç—å/–≤—ã–∫–ª—é—á–∏—Ç—å –≤—Å–µ –ª–æ–≥–≥–µ—Ä—ã
   CLoggerFactory::EnableAll(false);
   
   // –£–∑–Ω–∞—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–∑–¥–∞–Ω–Ω—ã—Ö –ª–æ–≥–≥–µ—Ä–æ–≤
   int count = CLoggerFactory::GetLoggerCount();
   Print("–°–æ–∑–¥–∞–Ω–æ –ª–æ–≥–≥–µ—Ä–æ–≤: " + IntegerToString(count));
   
   // –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–µ —Ä–∞–±–æ—Ç—ã
   ShutdownLogging();
}
```

## üõ° Thread Safety

–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç thread-safety –¥–ª—è MQL5:

```cpp
void MultiEventExample()
{
   // –≠—Ç–∏ –≤—ã–∑–æ–≤—ã –∏–∑ —Ä–∞–∑–Ω—ã—Ö —Å–æ–±—ã—Ç–∏–π –±–µ–∑–æ–ø–∞—Å–Ω—ã
   void OnTick()
   {
      LOG_INFO("–¢–∏–∫ –ø–æ–ª—É—á–µ–Ω –≤ OnTick");
   }
   
   void OnTimer()
   {
      LOG_INFO("–¢–∞–π–º–µ—Ä —Å—Ä–∞–±–æ—Ç–∞–ª –≤ OnTimer");
   }
   
   void OnTrade()
   {
      LOG_INFO("–¢–æ—Ä–≥–æ–≤–æ–µ —Å–æ–±—ã—Ç–∏–µ –≤ OnTrade");
   }
}
```

## üìã –ü–æ–ª–Ω—ã–π –ø—Ä–∏–º–µ—Ä –≤ —Å–æ–≤–µ—Ç–Ω–∏–∫–µ

```cpp
//+------------------------------------------------------------------+
//|                                                   MyExpert.mq5 |
//+------------------------------------------------------------------+
#include "Logger.mqh"

input ENUM_LOG_LEVEL LogLevel = LOG_INFO;  // –£—Ä–æ–≤–µ–Ω—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

ILogger* g_logger = NULL;

//+------------------------------------------------------------------+
//| Expert initialization function                                   |
//+------------------------------------------------------------------+
int OnInit()
{
   // –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ª–æ–≥–≥–µ—Ä
   SLoggerConfig config;
   config.level = LogLevel;
   config.console_output = true;
   config.file_output = true;
   config.log_file = "MyExpert.log";
   config.detailed_format = true;
   
   g_logger = CLoggerFactory::CreateLogger("MyExpert", config);
   
   if(g_logger == NULL)
   {
      Print("–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –ª–æ–≥–≥–µ—Ä–∞");
      return INIT_FAILED;
   }
   
   LOG_INFO("–°–æ–≤–µ—Ç–Ω–∏–∫ MyExpert –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω");
   return INIT_SUCCEEDED;
}

//+------------------------------------------------------------------+
//| Expert tick function                                             |
//+------------------------------------------------------------------+
void OnTick()
{
   LOG_EXECUTION_TIME("–û–±—Ä–∞–±–æ—Ç–∫–∞ —Ç–∏–∫–∞", {
      
      double price = SymbolInfoDouble(_Symbol, SYMBOL_BID);
      LOG_DEBUG("–¢–µ–∫—É—â–∞—è —Ü–µ–Ω–∞: " + DoubleToString(price, _Digits));
      
      // –ü—Ä–æ–≤–µ—Ä–∫–∞ —É—Å–ª–æ–≤–∏–π –¥–ª—è —Ç–æ—Ä–≥–æ–≤–ª–∏
      if(ShouldOpenTrade())
      {
         if(OpenTrade())
         {
            LOG_INFO("–°–¥–µ–ª–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∞ —É—Å–ø–µ—à–Ω–æ");
         }
         else
         {
            LOG_ERROR("–û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è —Å–¥–µ–ª–∫–∏");
         }
      }
   });
}

//+------------------------------------------------------------------+
//| Expert deinitialization function                                |
//+------------------------------------------------------------------+
void OnDeinit(const int reason)
{
   LOG_INFO("–°–æ–≤–µ—Ç–Ω–∏–∫ –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Ä–∞–±–æ—Ç—É. –ü—Ä–∏—á–∏–Ω–∞: " + IntegerToString(reason));
   
   // –°–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤—Å–µ –ª–æ–≥–∏
   FlushAllLoggers();
   
   // –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ –∑–∞–≤–µ—Ä—à–∏—Ç—å —Ä–∞–±–æ—Ç—É –ª–æ–≥–≥–µ—Ä–∞
   ShutdownLogging();
}

//+------------------------------------------------------------------+
//| Trade function                                                   |
//+------------------------------------------------------------------+
void OnTradeTransaction(const MqlTradeTransaction& trans,
                       const MqlTradeRequest& request,
                       const MqlTradeResult& result)
{
   if(result.retcode == TRADE_RETCODE_DONE)
   {
      LOG_TRADE_OPEN(_Symbol, request.type, request.volume, result.price);
   }
   else
   {
      LOG_ERROR_CODE("–û—à–∏–±–∫–∞ —Ç–æ—Ä–≥–æ–≤–æ–π –æ–ø–µ—Ä–∞—Ü–∏–∏", result.retcode);
   }
}

//+------------------------------------------------------------------+
//| Auxiliary functions                                              |
//+------------------------------------------------------------------+
bool ShouldOpenTrade()
{
   LOG_FUNCTION_ENTRY();
   
   // –í–∞—à–∞ –ª–æ–≥–∏–∫–∞ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏—è —Å–∏–≥–Ω–∞–ª–∞
   bool signal = true;
   
   LOG_IF(signal, LOG_DEBUG, "–°–∏–≥–Ω–∞–ª –¥–ª—è –æ—Ç–∫—Ä—ã—Ç–∏—è —Å–¥–µ–ª–∫–∏ –Ω–∞–π–¥–µ–Ω");
   
   LOG_FUNCTION_EXIT();
   return signal;
}

bool OpenTrade()
{
   LOG_FUNCTION_ENTRY();
   
   MqlTradeRequest request = {};
   MqlTradeResult result = {};
   
   request.action = TRADE_ACTION_DEAL;
   request.symbol = _Symbol;
   request.volume = 0.1;
   request.type = ORDER_TYPE_BUY;
   request.price = SymbolInfoDouble(_Symbol, SYMBOL_ASK);
   
   bool success = OrderSend(request, result);
   
   if(success)
   {
      LOG_INFO("–ó–∞–ø—Ä–æ—Å –Ω–∞ –æ—Ç–∫—Ä—ã—Ç–∏–µ —Å–¥–µ–ª–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω");
   }
   else
   {
      LOG_ERROR("–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Ç–æ—Ä–≥–æ–≤–æ–≥–æ –∑–∞–ø—Ä–æ—Å–∞", GetLastError());
   }
   
   LOG_FUNCTION_EXIT();
   return success;
}
```

## üîß –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

1. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã –ª–æ–≥–≥–µ—Ä–∞ –≤ —Ä–∞–±–æ—á—É—é –ø–∞–ø–∫—É –≤–∞—à–µ–≥–æ MetaTrader 5
2. –í –≤–∞—à–µ–º –∫–æ–¥–µ –¥–æ–±–∞–≤—å—Ç–µ: `#include "Logger.mqh"`
3. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –º–∞–∫—Ä–æ—Å—ã `LOG_INFO()`, `LOG_ERROR()` –∏ –¥—Ä—É–≥–∏–µ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
4. –ò–ª–∏ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π –ª–æ–≥–≥–µ—Ä —á–µ—Ä–µ–∑ `CLoggerFactory`

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏

- **–û—á–∏—Å—Ç–∫–∞ —Å—Ç–∞—Ä—ã—Ö –∑–∞–ø–∏—Å–µ–π**: `handler.ClearOldRecords(30)` - —É–¥–∞–ª–∏—Ç—å –∑–∞–ø–∏—Å–∏ —Å—Ç–∞—Ä—à–µ 30 –¥–Ω–µ–π
- **–ü–æ–¥—Å—á–µ—Ç –∑–∞–ø–∏—Å–µ–π**: `handler.GetRecordCount()` - –ø–æ–ª—É—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–ø–∏—Å–µ–π –≤ –ë–î
- **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±—É—Ñ–µ—Ä–∏–∑–∞—Ü–∏–∏**: `handler.SetFlushInterval(120)` - —Å–±—Ä–∞—Å—ã–≤–∞—Ç—å –∫–∞–∂–¥—ã–µ 2 –º–∏–Ω—É—Ç—ã
- **–ò—Å–∫–ª—é—á–µ–Ω–∏–µ —É—Ä–æ–≤–Ω–µ–π**: `filter.ExcludeLevel(LOG_DEBUG)` - –∏—Å–∫–ª—é—á–∏—Ç—å –æ—Ç–ª–∞–¥–æ—á–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è

---

**–ê–≤—Ç–æ—Ä**: kogriv  
**–í–µ—Ä—Å–∏—è**: 1.0.0  
**–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: MetaTrader 5, MQL5